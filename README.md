# Packy Usage Monitor

ä¸€ä¸ªç‹¬ç«‹çš„é¢„ç®—ç›‘æ§å·¥å…·ï¼Œç”¨äºå®æ—¶ç›‘æ§ Packy Code API çš„é¢„ç®—ä½¿ç”¨æƒ…å†µã€‚

## ğŸ¯ 30ç§’å¿«é€Ÿä¸Šæ‰‹

**Windows ç”¨æˆ·æœ€å¿«æ–¹æ³•ï¼š**
1. ğŸ“ ä¸‹è½½/å…‹éš†æœ¬é¡¹ç›®
2. ğŸ–±ï¸ åŒå‡» `packy.bat` æˆ– `packy.ps1`
3. ğŸ“ é€‰æ‹©èœå• 2 è®¾ç½® API Token
4. ğŸš€ é€‰æ‹©èœå• 6 å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜ç›‘æ§
5. âœ… å®Œæˆï¼æŸ¥çœ‹å³ä¸‹è§’ç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡

**ä¸€é”®å®‰è£…ï¼ˆå¯é€‰ï¼‰ï¼š**
- è¿è¡Œ `install.bat` å°†ç¨‹åºå®‰è£…åˆ°ç³»ç»Ÿï¼Œä¹‹åå¯åœ¨ä»»æ„ä½ç½®ä½¿ç”¨

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ–¥ï¸ **ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨** - å®æ—¶æ˜¾ç¤ºé¢„ç®—ä½¿ç”¨çŠ¶æ€ï¼Œç±»ä¼¼VS CodeçŠ¶æ€æ ä½“éªŒ
- ğŸ’» **å‘½ä»¤è¡Œå·¥å…·** - æ”¯æŒè„šæœ¬åŒ–å’Œè‡ªåŠ¨åŒ–ï¼Œå¤šç§æ˜¾ç¤ºæ ¼å¼
- âš ï¸ **æ™ºèƒ½é¢„è­¦** - è¶…è¿‡é˜ˆå€¼è‡ªåŠ¨é€šçŸ¥ï¼Œæ”¯æŒå…æ‰“æ‰°æ¨¡å¼
- ğŸ“Š **ä½¿ç”¨ç»Ÿè®¡** - è¯¦ç»†çš„é¢„ç®—ä½¿ç”¨ç‡åˆ†æå’Œè¶‹åŠ¿æ˜¾ç¤º
- ğŸ” **å®‰å…¨å­˜å‚¨** - API Token ç³»ç»Ÿå¯†é’¥ç¯åŠ å¯†ä¿æŠ¤
- ğŸŒ **ä»£ç†æ”¯æŒ** - ä¼ä¸šç½‘ç»œç¯å¢ƒå…¼å®¹ï¼Œæ”¯æŒHTTPä»£ç†
- ğŸ”„ **è‡ªåŠ¨è½®è¯¢** - å®šæœŸåˆ·æ–°é¢„ç®—æ•°æ®ï¼Œå®æ—¶ç›‘æ§

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ¯ æœ€å¿«ä¸Šæ‰‹æ–¹å¼ï¼ˆWindows ç”¨æˆ·æ¨èï¼‰

1. **ä¸‹è½½é¢„ç¼–è¯‘ç‰ˆæœ¬**ï¼š
   - è¿›å…¥ `dist` ç›®å½•ï¼Œæ‰¾åˆ° `packy-usage-monitor.exe`
   - æˆ–ä½¿ç”¨æä¾›çš„äº¤äº’å¼è„šæœ¬ï¼ˆè§ä¸‹æ–¹ï¼‰

2. **ä½¿ç”¨äº¤äº’å¼è„šæœ¬ï¼ˆæ— éœ€è®°å‘½ä»¤ï¼‰**ï¼š
   ```bash
   # æ–¹å¼1ï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆWindowsï¼‰
   åŒå‡» packy.bat
   # æˆ–åœ¨å‘½ä»¤è¡Œè¿è¡Œï¼š
   ./packy.bat

   # æ–¹å¼2ï¼šä½¿ç”¨ PowerShell è„šæœ¬ï¼ˆä¸­æ–‡æ”¯æŒæ›´å¥½ï¼‰
   å³é”® packy.ps1 -> ä½¿ç”¨ PowerShell è¿è¡Œ
   # æˆ–åœ¨ PowerShell ä¸­è¿è¡Œï¼š
   ./packy.ps1
   ```

   äº¤äº’å¼ç•Œé¢ä¼šæä¾›èœå•é€‰é¡¹ï¼Œä½ å¯ä»¥ï¼š
   - è¾“å…¥æ•°å­—é€‰æ‹©åŠŸèƒ½
   - æ— éœ€è®°ä½å¤æ‚çš„å‘½ä»¤å‚æ•°
   - æ”¯æŒä¸­æ–‡æ˜¾ç¤º

3. **ä¸€é”®å®‰è£…åˆ°ç³»ç»Ÿ**ï¼š
   ```bash
   # åŒå‡»è¿è¡Œå®‰è£…è„šæœ¬
   install.bat

   # å®‰è£…åå¯åœ¨ä»»æ„ä½ç½®è¿è¡Œï¼š
   packy-usage-monitor status
   ```

### æ–¹å¼1ï¼šä½¿ç”¨ä¾¿æ·è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

```bash
# Windows ç”¨æˆ·
1. åŒå‡» packy.bat æˆ– packy.ps1
2. åœ¨äº¤äº’å¼èœå•ä¸­é€‰æ‹©åŠŸèƒ½
3. é¦–æ¬¡ä½¿ç”¨é€‰æ‹© "2. é…ç½®è®¾ç½®" è®¾ç½® Token
4. ç„¶åé€‰æ‹© "6. å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨"
```

### æ–¹å¼2ï¼šä»æºç è¿è¡Œ

```bash
# 0. è¿›å…¥é¡¹ç›®ç›®å½•
cd packy-usage-script

# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. é…ç½® API Token
python packy_usage.py config set-token

# 3. å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨
python packy_usage.py tray
```

### æ–¹å¼3ï¼šä½¿ç”¨æ‰“åŒ…ç‰ˆæœ¬

```bash
# 0. è¿›å…¥é¡¹ç›®ç›®å½•
cd packy-usage-script

# 1. æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶
python build.py

# 2. è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶
cd dist
./packy-usage-monitor --help  # Linux/Mac
packy-usage-monitor.exe --help  # Windows
```

## ğŸ“‹ ä½¿ç”¨æ–¹å¼

### ç³»ç»Ÿæ‰˜ç›˜æ¨¡å¼ï¼ˆæ¨èï¼‰

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨
python packy_usage.py tray
```

- æ˜¾ç¤ºå®æ—¶é¢„ç®—ä½¿ç”¨ç‡å›¾æ ‡
- å³é”®èœå•æä¾›å¿«é€Ÿæ“ä½œ
- è‡ªåŠ¨é¢„è­¦é€šçŸ¥
- ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯

### å‘½ä»¤è¡Œæ¨¡å¼

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# æŸ¥çœ‹å½“å‰é¢„ç®—çŠ¶æ€
python packy_usage.py status

# ç®€è¦æ˜¾ç¤º
python packy_usage.py status --brief
# è¾“å‡º: [æ­£å¸¸] æ—¥é¢„ç®—: 65.2% | [è­¦å‘Š] æœˆé¢„ç®—: 78.9%

# è¯¦ç»†æ˜¾ç¤ºï¼ˆé»˜è®¤ï¼‰
python packy_usage.py status

# JSONæ ¼å¼è¾“å‡ºï¼ˆä¾¿äºé›†æˆå…¶ä»–å·¥å…·ï¼‰
python packy_usage.py status --json

# ä»…æ˜¾ç¤ºè­¦å‘ŠçŠ¶æ€
python packy_usage.py status --alert-only
```

### å®æ—¶ç›‘æ§æ¨¡å¼

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# å¯åŠ¨å®æ—¶ç›‘æ§ï¼ˆç±»ä¼¼ htop é£æ ¼ï¼‰
python packy_usage.py watch --interval 30

# è‡ªå®šä¹‰åˆ·æ–°é—´éš”ï¼ˆå•ä½ï¼šç§’ï¼‰
python packy_usage.py watch --interval 10
```

### CI/CD é›†æˆ

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹æˆ–æŒ‡å®šå®Œæ•´è·¯å¾„
cd /path/to/packy-usage-script

# æ£€æŸ¥é¢„ç®—çŠ¶æ€ï¼Œé€‚ç”¨äºæ„å»ºè„šæœ¬
python packy_usage.py check --threshold 90

# è¿”å›ç ï¼š
# 0 = æ­£å¸¸
# 1 = è¶…è¿‡é˜ˆå€¼
# 2 = æ£€æŸ¥å¤±è´¥
```

## âš™ï¸ é…ç½®ç®¡ç†

### Token é…ç½®

æ”¯æŒä¸¤ç§ Token ç±»å‹ï¼š

1. **API Tokenï¼ˆæ¨èï¼‰**
   ```bash
   cd /path/to/packy-usage-script
   python packy_usage.py config set-token
   # è¾“å…¥ä»¥ 'sk-' å¼€å¤´çš„æ°¸ä¹…API Token
   ```

2. **JWT Token**
   ```bash
   # ä» PackyCode Dashboard Cookie è·å–
   # 1. è®¿é—® PackyCode Dashboard
   # 2. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   # 3. Application > Cookies > å¤åˆ¶ 'token' å€¼
   cd /path/to/packy-usage-script
   python packy_usage.py config set-token
   ```

### æŸ¥çœ‹å’Œç®¡ç†é…ç½®

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# æ˜¾ç¤ºå½“å‰é…ç½®
python packy_usage.py config show

# é‡ç½®ä¸ºé»˜è®¤é…ç½®
python packy_usage.py config reset
```

### é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½ç½®ï¼š`~/.packy-usage/config.yaml`

å‚è€ƒ `config.example.yaml` äº†è§£æ‰€æœ‰é…ç½®é€‰é¡¹ã€‚

## ğŸ”§ ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½

- **å›¾æ ‡çŠ¶æ€**ï¼š
  - ğŸŸ¢ ç»¿è‰²ï¼šä½¿ç”¨ç‡æ­£å¸¸ (< 50%)
  - ğŸ”µ è“è‰²ï¼šä¸­ç­‰ä½¿ç”¨ (50-75%)
  - ğŸŸ¡ é»„è‰²ï¼šè­¦å‘ŠçŠ¶æ€ (75-90%)
  - ğŸ”´ çº¢è‰²ï¼šä¸¥é‡çŠ¶æ€ (â‰¥ 90%)
  - âšª ç°è‰²ï¼šåˆå§‹åŒ–æˆ–é”™è¯¯

- **å³é”®èœå•**ï¼š
  - ğŸ“Š æ˜¾ç¤ºè¯¦æƒ…ï¼šæŸ¥çœ‹è¯¦ç»†é¢„ç®—ä¿¡æ¯
  - ğŸ”„ åˆ·æ–°ï¼šç«‹å³æ›´æ–°æ•°æ®
  - âš™ï¸ è®¾ç½®ï¼šé…ç½®é€‰é¡¹
  - âŒ é€€å‡ºï¼šå…³é—­åº”ç”¨

## ğŸ“Š é€šçŸ¥åŠŸèƒ½

### æ™ºèƒ½é¢„è­¦
- ä½¿ç”¨ç‡è¶…è¿‡75%ï¼šè­¦å‘Šé€šçŸ¥
- ä½¿ç”¨ç‡è¶…è¿‡90%ï¼šä¸¥é‡è­¦å‘Šé€šçŸ¥
- æ”¯æŒé€šçŸ¥å»é‡ï¼Œé¿å…é‡å¤æ‰“æ‰°

### å…æ‰“æ‰°æ¨¡å¼
- é»˜è®¤22:00-08:00é™é»˜æ—¶é—´
- ä¸¥é‡è­¦å‘Šä»ä¼šå‘é€é€šçŸ¥
- å¯é€šè¿‡é…ç½®æ–‡ä»¶è‡ªå®šä¹‰

## ğŸ”§ å¼€å‘å’Œæ„å»º

### å¼€å‘ç¯å¢ƒ

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/packy-usage-script

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œæµ‹è¯•
pytest

# ä»£ç æ ¼å¼åŒ–
black packy_usage/
flake8 packy_usage/
```

### æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/packy-usage-script

# è‡ªåŠ¨æ„å»º
python build.py

# æ„å»ºè¾“å‡ºä½ç½®ï¼šdist/
# åŒ…å«ï¼š
# - å¯æ‰§è¡Œæ–‡ä»¶ (Windows: .exe, Linux/Mac: æ— æ‰©å±•å)
# - å®‰è£…è„šæœ¬
# - README
```

### é¡¹ç›®ç»“æ„

```
packy-usage-script/
â”œâ”€â”€ packy.bat              # Windows äº¤äº’å¼å¯åŠ¨å™¨
â”œâ”€â”€ packy.ps1              # PowerShell äº¤äº’å¼å¯åŠ¨å™¨ï¼ˆä¸­æ–‡æ”¯æŒï¼‰
â”œâ”€â”€ install.bat            # Windows ä¸€é”®å®‰è£…è„šæœ¬
â”œâ”€â”€ packy_usage.py         # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ build.py              # æ„å»ºè„šæœ¬
â”œâ”€â”€ config.example.yaml   # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ dist/                 # ç¼–è¯‘è¾“å‡ºç›®å½•
â”‚   â””â”€â”€ packy-usage-monitor.exe  # å¯æ‰§è¡Œæ–‡ä»¶
â””â”€â”€ packy_usage/          # ä¸»è¦ä»£ç åŒ…
    â”œâ”€â”€ cli/              # å‘½ä»¤è¡Œç•Œé¢
    â”œâ”€â”€ core/             # æ ¸å¿ƒåŠŸèƒ½ï¼ˆAPIã€æ•°æ®æ¨¡å‹ï¼‰
    â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
    â”œâ”€â”€ security/         # å®‰å…¨åŠŸèƒ½ï¼ˆTokenå­˜å‚¨ï¼‰
    â”œâ”€â”€ ui/               # ç”¨æˆ·ç•Œé¢ï¼ˆæ‰˜ç›˜ã€é€šçŸ¥ã€æ˜¾ç¤ºï¼‰
    â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
```

## ğŸŒ ç½‘ç»œå’Œä»£ç†

### ä»£ç†é…ç½®

æ”¯æŒå¤šç§ä»£ç†é…ç½®æ–¹å¼ï¼š

1. **é…ç½®æ–‡ä»¶**ï¼š
   ```yaml
   network:
     proxy: "http://proxy.company.com:8080"
   ```

2. **ç¯å¢ƒå˜é‡**ï¼š
   ```bash
   export HTTP_PROXY=http://proxy.company.com:8080
   export HTTPS_PROXY=http://proxy.company.com:8080
   ```

### SSL è¯ä¹¦

- é»˜è®¤å¯ç”¨SSLéªŒè¯
- ä¼ä¸šç¯å¢ƒå¯é€šè¿‡é…ç½®ç¦ç”¨ï¼š
  ```yaml
  network:
    verify_ssl: false
  ```

## ğŸ› é—®é¢˜æ’æŸ¥

### å¸¸è§é—®é¢˜

1. **Token æ— æ•ˆ**
   ```bash
   # é‡æ–°é…ç½®Tokenï¼ˆç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼‰
   cd /path/to/packy-usage-script
   python packy_usage.py config set-token
   ```

2. **ç½‘ç»œè¿æ¥å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤ä»£ç†è®¾ç½®
   - æ£€æŸ¥é˜²ç«å¢™è§„åˆ™

3. **ç³»ç»Ÿæ‰˜ç›˜ä¸æ˜¾ç¤º**
   - ç¡®ä¿å®‰è£…äº†æ‰€æœ‰GUIä¾èµ–
   - Linuxéœ€è¦ç³»ç»Ÿæ‰˜ç›˜æ”¯æŒ
   - macOSå¯èƒ½éœ€è¦æƒé™è®¾ç½®

4. **é€šçŸ¥ä¸å·¥ä½œ**
   - æ£€æŸ¥ç³»ç»Ÿé€šçŸ¥æƒé™
   - ç¡®è®¤é€šçŸ¥æœåŠ¡è¿è¡Œ
   - æŸ¥çœ‹é€šçŸ¥é…ç½®

### æ—¥å¿—è°ƒè¯•

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# å¯ç”¨è°ƒè¯•æ—¥å¿—
python packy_usage.py --config-dir ~/.packy-usage-debug config show

# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f ~/.packy-usage/app.log  # Linux/Mac
type %USERPROFILE%\.packy-usage\app.log  # Windows
```

## ğŸ“š æ–‡æ¡£

- **ğŸ“– [ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ](docs/USER_GUIDE.md)** - è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œé…ç½®æŒ‡å—
- **ğŸš€ [å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/QUICK_START.md)** - 3åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
- **ğŸ› ï¸ [å¼€å‘è€…æŒ‡å—](docs/DEVELOPER_GUIDE.md)** - æ¶æ„è®¾è®¡å’Œå¼€å‘è§„èŒƒ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

## ğŸ™ è‡´è°¢

- åŸºäº VS Code æ‰©å±• `packy-usage-vsce` çš„è®¾è®¡ç†å¿µ
- ä½¿ç”¨ `pystray` å®ç°è·¨å¹³å°ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½
- ä½¿ç”¨ `keyring` æä¾›å®‰å…¨çš„å‡­æ®å­˜å‚¨