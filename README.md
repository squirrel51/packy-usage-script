# Packy Usage Monitor

ä¸€ä¸ªç‹¬ç«‹çš„é¢„ç®—ç›‘æ§å·¥å…·ï¼Œç”¨äºå®æ—¶ç›‘æ§ Packy Code API çš„é¢„ç®—ä½¿ç”¨æƒ…å†µã€‚

## ğŸ¯ 30ç§’å¿«é€Ÿä¸Šæ‰‹

### ğŸŒŸ æ¨èæ–¹æ³•ï¼ˆWindows ç”¨æˆ·ï¼‰

**ä½¿ç”¨ PowerShell äº¤äº’å¼è„šæœ¬ï¼ˆæœ€ä½³ä½“éªŒï¼‰ï¼š**
1. ğŸ“ ä¸‹è½½/å…‹éš†æœ¬é¡¹ç›®
2. ğŸ–±ï¸ å³é”® `packy.ps1` â†’ é€‰æ‹©"ä½¿ç”¨ PowerShell è¿è¡Œ"
3. ğŸ“ åœ¨èœå•ä¸­è¾“å…¥ `2` é…ç½® API Token
4. ğŸš€ è¾“å…¥ `7` å¯åŠ¨å®æ—¶ç›‘æ§ï¼Œæˆ–è¾“å…¥ `6` å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜
5. âœ… å®Œæˆï¼äº«å—ç¾è§‚çš„ç•Œé¢å’Œæµç•…çš„ä½“éªŒ

> ğŸ’¡ **ä¸ºä»€ä¹ˆæ¨è PowerShellï¼Ÿ**
> - âœ¨ æ›´å¥½çš„ä¸­æ–‡æ˜¾ç¤ºæ”¯æŒ
> - ğŸ¨ å®Œç¾çš„ç•Œé¢å¯¹é½å’Œæ ¼å¼
> - ğŸš€ å®æ—¶ç›‘æ§ä¸ä¼šå¡æ­»
> - ğŸ“Š æ•°æ®å±•ç¤ºæ›´æ¸…æ™°ç¾è§‚

### å¤‡é€‰æ–¹æ³•

**æ‰¹å¤„ç†è„šæœ¬ï¼š**
- åŒå‡» `packy.bat` ä½¿ç”¨ä¼ ç»Ÿæ‰¹å¤„ç†ç•Œé¢

**ä¸€é”®å®‰è£…ï¼ˆå¯é€‰ï¼‰ï¼š**
- è¿è¡Œ `install.bat` å°†ç¨‹åºå®‰è£…åˆ°ç³»ç»Ÿï¼Œä¹‹åå¯åœ¨ä»»æ„ä½ç½®ä½¿ç”¨

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ–¥ï¸ **ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨** - å®æ—¶æ˜¾ç¤ºé¢„ç®—ä½¿ç”¨çŠ¶æ€ï¼Œç±»ä¼¼VS CodeçŠ¶æ€æ ä½“éªŒ
- ğŸ’» **å‘½ä»¤è¡Œå·¥å…·** - æ”¯æŒè„šæœ¬åŒ–å’Œè‡ªåŠ¨åŒ–ï¼Œå¤šç§æ˜¾ç¤ºæ ¼å¼
- âš ï¸ **æ™ºèƒ½é¢„è­¦** - è¶…è¿‡é˜ˆå€¼è‡ªåŠ¨é€šçŸ¥ï¼Œæ”¯æŒå…æ‰“æ‰°æ¨¡å¼
- ğŸ“Š **ä½¿ç”¨ç»Ÿè®¡** - è¯¦ç»†çš„é¢„ç®—ä½¿ç”¨ç‡åˆ†æå’Œè¶‹åŠ¿æ˜¾ç¤º
- ğŸ” **å®‰å…¨å­˜å‚¨** - API Token ç³»ç»Ÿå¯†é’¥ç¯åŠ å¯†ä¿æŠ¤
- ğŸŒ **ä»£ç†æ”¯æŒ** - ä¼ä¸šç½‘ç»œç¯å¢ƒå…¼å®¹ï¼Œæ”¯æŒHTTPä»£ç†
- ğŸ”„ **è‡ªåŠ¨è½®è¯¢** - å®šæœŸåˆ·æ–°é¢„ç®—æ•°æ®ï¼Œå®æ—¶ç›‘æ§

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ¯ æœ€å¿«ä¸Šæ‰‹æ–¹å¼ï¼ˆå¼ºçƒˆæ¨èï¼‰

**ä½¿ç”¨ PowerShell äº¤äº’å¼è„šæœ¬ï¼š**

```powershell
# æ–¹å¼1ï¼šå›¾å½¢ç•Œé¢æ“ä½œ
1. æ‰¾åˆ° packy.ps1 æ–‡ä»¶
2. å³é”®ç‚¹å‡» â†’ é€‰æ‹©"ä½¿ç”¨ PowerShell è¿è¡Œ"
3. åœ¨äº¤äº’å¼èœå•ä¸­é€‰æ‹©åŠŸèƒ½

# æ–¹å¼2ï¼šå‘½ä»¤è¡Œè¿è¡Œ
./packy.ps1
```

**äº¤äº’å¼èœå•åŠŸèƒ½ï¼š**
- `[1]` æ£€æŸ¥ä½¿ç”¨çŠ¶æ€ - å¿«é€ŸæŸ¥çœ‹å½“å‰é¢„ç®—
- `[2]` é…ç½®è®¾ç½® - è®¾ç½® API Tokenï¼ˆé¦–æ¬¡ä½¿ç”¨å¿…é¡»ï¼‰
- `[3]` ç³»ç»Ÿè¯Šæ–­ - æ£€æŸ¥ç¯å¢ƒå’Œè¿æ¥
- `[4]` æ€§èƒ½æµ‹è¯• - æµ‹è¯•å“åº”é€Ÿåº¦
- `[5]` æ˜¾ç¤ºå½“å‰çŠ¶æ€ - è¯¦ç»†é¢„ç®—æŠ¥å‘Š
- `[6]` å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜ - åå°ç›‘æ§æ¨¡å¼
- `[7]` å®æ—¶ç›‘æ§æ¨¡å¼ - ç»ˆç«¯å®æ—¶æ˜¾ç¤ºï¼ˆæ¨èä½“éªŒï¼‰
- `[0]` é€€å‡ºç¨‹åº

> ğŸŒŸ **æ¨èå·¥ä½œæµç¨‹ï¼š**
> 1. é¦–æ¬¡ä½¿ç”¨é€‰æ‹© `[2]` è®¾ç½® Token
> 2. é€‰æ‹© `[3]` è¿›è¡Œç³»ç»Ÿè¯Šæ–­ç¡®ä¿ä¸€åˆ‡æ­£å¸¸
> 3. é€‰æ‹© `[7]` ä½“éªŒç¾è§‚çš„å®æ—¶ç›‘æ§ç•Œé¢
> 4. æˆ–é€‰æ‹© `[6]` å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜åå°è¿è¡Œ

### å¤‡é€‰æ–¹å¼

**æ‰¹å¤„ç†è„šæœ¬ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰ï¼š**
```bash
# åŒå‡»è¿è¡Œæˆ–å‘½ä»¤è¡Œæ‰§è¡Œ
packy.bat
```

**ä¸€é”®å®‰è£…åˆ°ç³»ç»Ÿï¼š**
```bash
# å®‰è£…åå¯åœ¨ä»»æ„ä½ç½®ä½¿ç”¨
install.bat
```

### ä»æºç è¿è¡Œ

```bash
# 0. è¿›å…¥é¡¹ç›®ç›®å½•
cd packy-usage-script

# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. é…ç½® API Token
python packy_usage.py config set-token

# 3. å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨
python packy_usage.py tray
```

### æ–¹å¼3ï¼šä½¿ç”¨æ‰“åŒ…ç‰ˆæœ¬

```bash
# ç›´æ¥è¿è¡Œç¼–è¯‘å¥½çš„å¯æ‰§è¡Œæ–‡ä»¶
dist\packy-usage-monitor.exe --help  # Windows

# æˆ–ä½¿ç”¨äº¤äº’å¼è„šæœ¬å¯åŠ¨ï¼ˆæ¨èï¼‰
./packy.ps1  # ä¼šè‡ªåŠ¨è°ƒç”¨ dist ç›®å½•ä¸‹çš„ exe
```

## ğŸ“‹ ä½¿ç”¨æ–¹å¼

### ç³»ç»Ÿæ‰˜ç›˜æ¨¡å¼ï¼ˆæ¨èï¼‰

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# å¯åŠ¨ç³»ç»Ÿæ‰˜ç›˜åº”ç”¨
python packy_usage.py tray
```

- æ˜¾ç¤ºå®æ—¶é¢„ç®—ä½¿ç”¨ç‡å›¾æ ‡
- å³é”®èœå•æä¾›å¿«é€Ÿæ“ä½œ
- è‡ªåŠ¨é¢„è­¦é€šçŸ¥
- ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯

### å‘½ä»¤è¡Œæ¨¡å¼

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# æŸ¥çœ‹å½“å‰é¢„ç®—çŠ¶æ€
python packy_usage.py status

# ç®€è¦æ˜¾ç¤º
python packy_usage.py status --brief
# è¾“å‡º: [æ­£å¸¸] æ—¥é¢„ç®—: 65.2% | [è­¦å‘Š] æœˆé¢„ç®—: 78.9%

# è¯¦ç»†æ˜¾ç¤ºï¼ˆé»˜è®¤ï¼‰
python packy_usage.py status

# JSONæ ¼å¼è¾“å‡ºï¼ˆä¾¿äºé›†æˆå…¶ä»–å·¥å…·ï¼‰
python packy_usage.py status --json

# ä»…æ˜¾ç¤ºè­¦å‘ŠçŠ¶æ€
python packy_usage.py status --alert-only
```

### å®æ—¶ç›‘æ§æ¨¡å¼ï¼ˆæ¨èä½“éªŒï¼‰

```bash
# ä½¿ç”¨ PowerShell è„šæœ¬å¯åŠ¨ï¼ˆæœ€ä½³ä½“éªŒï¼‰
./packy.ps1
# é€‰æ‹© [7] å®æ—¶ç›‘æ§æ¨¡å¼

# æˆ–ç›´æ¥å‘½ä»¤è¡Œå¯åŠ¨
python packy_usage.py watch --interval 30

# è‡ªå®šä¹‰åˆ·æ–°é—´éš”ï¼ˆå•ä½ï¼šç§’ï¼‰
python packy_usage.py watch --interval 10
```

**å®æ—¶ç›‘æ§ç•Œé¢é¢„è§ˆï¼š**
```
============================================================
  Packy é¢„ç®—ç›‘æ§ - 20:16:10 (åˆ·æ–°é—´éš”: 30ç§’)
============================================================

             æ—¥é¢„ç®—             |            æœˆé¢„ç®—
  ---------------------------+---------------------------
  ###########---------        | ###-----------------
    55.7% å·²ä½¿ç”¨               |   17.3% å·²ä½¿ç”¨

  å·²ä½¿ç”¨:     $55.68          | å·²ä½¿ç”¨:    $517.99
  æ€»é¢åº¦:    $100.00          | æ€»é¢åº¦:  $3,000.00
  å‰©ä½™é¢:     $44.32          | å‰©ä½™é¢:  $2,482.01

  çŠ¶æ€: âœ… æ­£å¸¸                | çŠ¶æ€: âœ… æ­£å¸¸
============================================================
```

### CI/CD é›†æˆ

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹æˆ–æŒ‡å®šå®Œæ•´è·¯å¾„
cd /path/to/packy-usage-script

# æ£€æŸ¥é¢„ç®—çŠ¶æ€ï¼Œé€‚ç”¨äºæ„å»ºè„šæœ¬
python packy_usage.py check --threshold 90

# è¿”å›ç ï¼š
# 0 = æ­£å¸¸
# 1 = è¶…è¿‡é˜ˆå€¼
# 2 = æ£€æŸ¥å¤±è´¥
```

## âš™ï¸ é…ç½®ç®¡ç†

### Token é…ç½®

æ”¯æŒä¸¤ç§ Token ç±»å‹ï¼š

1. **API Tokenï¼ˆæ¨èï¼‰**
   ```bash
   cd /path/to/packy-usage-script
   python packy_usage.py config set-token
   # è¾“å…¥ä»¥ 'sk-' å¼€å¤´çš„æ°¸ä¹…API Token
   ```

2. **JWT Token**
   ```bash
   # ä» PackyCode Dashboard Cookie è·å–
   # 1. è®¿é—® PackyCode Dashboard
   # 2. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   # 3. Application > Cookies > å¤åˆ¶ 'token' å€¼
   cd /path/to/packy-usage-script
   python packy_usage.py config set-token
   ```

### æŸ¥çœ‹å’Œç®¡ç†é…ç½®

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# æ˜¾ç¤ºå½“å‰é…ç½®
python packy_usage.py config show

# é‡ç½®ä¸ºé»˜è®¤é…ç½®
python packy_usage.py config reset
```

### é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½ç½®ï¼š`~/.packy-usage/config.yaml`

å‚è€ƒ `config.example.yaml` äº†è§£æ‰€æœ‰é…ç½®é€‰é¡¹ã€‚

## ğŸ”§ ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½

- **å›¾æ ‡çŠ¶æ€**ï¼š
  - ğŸŸ¢ ç»¿è‰²ï¼šä½¿ç”¨ç‡æ­£å¸¸ (< 50%)
  - ğŸ”µ è“è‰²ï¼šä¸­ç­‰ä½¿ç”¨ (50-75%)
  - ğŸŸ¡ é»„è‰²ï¼šè­¦å‘ŠçŠ¶æ€ (75-90%)
  - ğŸ”´ çº¢è‰²ï¼šä¸¥é‡çŠ¶æ€ (â‰¥ 90%)
  - âšª ç°è‰²ï¼šåˆå§‹åŒ–æˆ–é”™è¯¯

- **å³é”®èœå•**ï¼š
  - ğŸ“Š æ˜¾ç¤ºè¯¦æƒ…ï¼šæŸ¥çœ‹è¯¦ç»†é¢„ç®—ä¿¡æ¯
  - ğŸ”„ åˆ·æ–°ï¼šç«‹å³æ›´æ–°æ•°æ®
  - âš™ï¸ è®¾ç½®ï¼šé…ç½®é€‰é¡¹
  - âŒ é€€å‡ºï¼šå…³é—­åº”ç”¨

## ğŸ“Š é€šçŸ¥åŠŸèƒ½

### æ™ºèƒ½é¢„è­¦
- ä½¿ç”¨ç‡è¶…è¿‡75%ï¼šè­¦å‘Šé€šçŸ¥
- ä½¿ç”¨ç‡è¶…è¿‡90%ï¼šä¸¥é‡è­¦å‘Šé€šçŸ¥
- æ”¯æŒé€šçŸ¥å»é‡ï¼Œé¿å…é‡å¤æ‰“æ‰°

### å…æ‰“æ‰°æ¨¡å¼
- é»˜è®¤22:00-08:00é™é»˜æ—¶é—´
- ä¸¥é‡è­¦å‘Šä»ä¼šå‘é€é€šçŸ¥
- å¯é€šè¿‡é…ç½®æ–‡ä»¶è‡ªå®šä¹‰

## ğŸ”§ å¼€å‘å’Œæ„å»º

### å¼€å‘ç¯å¢ƒ

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/packy-usage-script

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œæµ‹è¯•
pytest

# ä»£ç æ ¼å¼åŒ–
black packy_usage/
flake8 packy_usage/
```

### æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/packy-usage-script

# è‡ªåŠ¨æ„å»º
python build.py

# æ„å»ºè¾“å‡ºä½ç½®ï¼šdist/
# åŒ…å«ï¼š
# - å¯æ‰§è¡Œæ–‡ä»¶ (Windows: .exe, Linux/Mac: æ— æ‰©å±•å)
# - å®‰è£…è„šæœ¬
# - README
```

### é¡¹ç›®ç»“æ„

```
packy-usage-script/
â”œâ”€â”€ packy.bat              # Windows äº¤äº’å¼å¯åŠ¨å™¨
â”œâ”€â”€ packy.ps1              # PowerShell äº¤äº’å¼å¯åŠ¨å™¨ï¼ˆä¸­æ–‡æ”¯æŒï¼‰
â”œâ”€â”€ install.bat            # Windows ä¸€é”®å®‰è£…è„šæœ¬
â”œâ”€â”€ packy_usage.py         # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ requirements.txt       # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ build.py              # æ„å»ºè„šæœ¬
â”œâ”€â”€ config.example.yaml   # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ dist/                 # ç¼–è¯‘è¾“å‡ºç›®å½•
â”‚   â””â”€â”€ packy-usage-monitor.exe  # å¯æ‰§è¡Œæ–‡ä»¶
â””â”€â”€ packy_usage/          # ä¸»è¦ä»£ç åŒ…
    â”œâ”€â”€ cli/              # å‘½ä»¤è¡Œç•Œé¢
    â”œâ”€â”€ core/             # æ ¸å¿ƒåŠŸèƒ½ï¼ˆAPIã€æ•°æ®æ¨¡å‹ï¼‰
    â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
    â”œâ”€â”€ security/         # å®‰å…¨åŠŸèƒ½ï¼ˆTokenå­˜å‚¨ï¼‰
    â”œâ”€â”€ ui/               # ç”¨æˆ·ç•Œé¢ï¼ˆæ‰˜ç›˜ã€é€šçŸ¥ã€æ˜¾ç¤ºï¼‰
    â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
```

## ğŸŒ ç½‘ç»œå’Œä»£ç†

### ä»£ç†é…ç½®

æ”¯æŒå¤šç§ä»£ç†é…ç½®æ–¹å¼ï¼š

1. **é…ç½®æ–‡ä»¶**ï¼š
   ```yaml
   network:
     proxy: "http://proxy.company.com:8080"
   ```

2. **ç¯å¢ƒå˜é‡**ï¼š
   ```bash
   export HTTP_PROXY=http://proxy.company.com:8080
   export HTTPS_PROXY=http://proxy.company.com:8080
   ```

### SSL è¯ä¹¦

- é»˜è®¤å¯ç”¨SSLéªŒè¯
- ä¼ä¸šç¯å¢ƒå¯é€šè¿‡é…ç½®ç¦ç”¨ï¼š
  ```yaml
  network:
    verify_ssl: false
  ```

## ğŸ› é—®é¢˜æ’æŸ¥

### å¸¸è§é—®é¢˜

1. **Token æ— æ•ˆ**
   ```bash
   # é‡æ–°é…ç½®Tokenï¼ˆç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼‰
   cd /path/to/packy-usage-script
   python packy_usage.py config set-token
   ```

2. **ç½‘ç»œè¿æ¥å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤ä»£ç†è®¾ç½®
   - æ£€æŸ¥é˜²ç«å¢™è§„åˆ™

3. **ç³»ç»Ÿæ‰˜ç›˜ä¸æ˜¾ç¤º**
   - ç¡®ä¿å®‰è£…äº†æ‰€æœ‰GUIä¾èµ–
   - Linuxéœ€è¦ç³»ç»Ÿæ‰˜ç›˜æ”¯æŒ
   - macOSå¯èƒ½éœ€è¦æƒé™è®¾ç½®

4. **é€šçŸ¥ä¸å·¥ä½œ**
   - æ£€æŸ¥ç³»ç»Ÿé€šçŸ¥æƒé™
   - ç¡®è®¤é€šçŸ¥æœåŠ¡è¿è¡Œ
   - æŸ¥çœ‹é€šçŸ¥é…ç½®

### æ—¥å¿—è°ƒè¯•

```bash
# ç¡®ä¿åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ
cd /path/to/packy-usage-script

# å¯ç”¨è°ƒè¯•æ—¥å¿—
python packy_usage.py --config-dir ~/.packy-usage-debug config show

# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f ~/.packy-usage/app.log  # Linux/Mac
type %USERPROFILE%\.packy-usage\app.log  # Windows
```

## ğŸ“š æ–‡æ¡£

- **ğŸ“– [ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ](docs/USER_GUIDE.md)** - è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œé…ç½®æŒ‡å—
- **ğŸš€ [å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/QUICK_START.md)** - 3åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
- **ğŸ› ï¸ [å¼€å‘è€…æŒ‡å—](docs/DEVELOPER_GUIDE.md)** - æ¶æ„è®¾è®¡å’Œå¼€å‘è§„èŒƒ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

## ğŸ™ è‡´è°¢

- åŸºäº VS Code æ‰©å±• `packy-usage-vsce` çš„è®¾è®¡ç†å¿µ
- ä½¿ç”¨ `pystray` å®ç°è·¨å¹³å°ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½
- ä½¿ç”¨ `keyring` æä¾›å®‰å…¨çš„å‡­æ®å­˜å‚¨